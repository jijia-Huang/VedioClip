# video-loading Specification

## Purpose
定義影片載入功能的規範，包括檔案選擇、影片資訊取得、資訊顯示、狀態管理和錯誤處理。此功能讓使用者能夠載入影片檔案並查看基本資訊（時長、解析度、格式、位元率），為後續剪輯功能提供基礎。
## Requirements
### Requirement: 影片檔案選擇
系統 SHALL 提供檔案選擇對話框，讓使用者選擇要載入的影片檔案。

#### Scenario: 使用者選擇影片檔案
- **WHEN** 使用者點擊載入影片按鈕
- **THEN** 顯示檔案選擇對話框
- **AND** 對話框僅顯示支援的影片格式（mp4, avi, mov, mkv 等）
- **AND** 使用者選擇檔案後，系統開始載入影片

#### Scenario: 使用者取消選擇
- **WHEN** 使用者在檔案選擇對話框中點擊取消
- **THEN** 不載入任何檔案
- **AND** 保持當前狀態不變

### Requirement: 影片資訊取得
系統 SHALL 使用 FFmpeg 的 ffprobe 取得影片的基本資訊。

#### Scenario: 成功取得影片資訊
- **WHEN** 使用者選擇有效的影片檔案
- **THEN** 系統使用 ffprobe 分析影片
- **AND** 取得影片時長（秒數）
- **AND** 取得影片解析度（寬度、高度）
- **AND** 取得影片格式
- **AND** 取得影片位元率

#### Scenario: 影片檔案不存在
- **WHEN** 使用者選擇的檔案路徑不存在
- **THEN** 系統顯示錯誤訊息
- **AND** 不載入影片

#### Scenario: 不支援的影片格式
- **WHEN** 使用者選擇不支援的檔案格式
- **THEN** 系統顯示格式不支援的錯誤訊息
- **AND** 不載入影片

#### Scenario: FFmpeg 執行失敗
- **WHEN** FFmpeg 無法執行或分析影片失敗
- **THEN** 系統顯示錯誤訊息
- **AND** 提供可能的解決方案（檢查 FFmpeg 安裝）

### Requirement: 影片資訊顯示
系統 SHALL 在 UI 中顯示載入影片的基本資訊。

#### Scenario: 顯示影片資訊
- **WHEN** 影片成功載入
- **THEN** 顯示影片檔案路徑或名稱
- **AND** 顯示影片時長（格式化為 時:分:秒）
- **AND** 顯示影片解析度（寬度 x 高度）
- **AND** 顯示影片格式
- **AND** 顯示影片位元率（格式化為適當單位）

#### Scenario: 載入中狀態
- **WHEN** 系統正在取得影片資訊
- **THEN** 顯示載入指示器或載入訊息
- **AND** 禁用載入按鈕防止重複操作

### Requirement: 影片狀態管理
系統 SHALL 使用狀態管理儲存當前載入的影片資訊。

#### Scenario: 儲存影片狀態
- **WHEN** 影片成功載入
- **THEN** 影片路徑和資訊儲存在狀態管理中
- **AND** 其他元件可以存取當前載入的影片資訊

#### Scenario: 清除影片
- **WHEN** 使用者清除當前載入的影片
- **THEN** 從狀態管理中移除影片資訊
- **AND** UI 恢復到未載入狀態

### Requirement: 錯誤處理
系統 SHALL 妥善處理各種錯誤情況並提供友善的錯誤訊息。

#### Scenario: 檔案讀取錯誤
- **WHEN** 無法讀取影片檔案
- **THEN** 顯示「無法讀取檔案」的錯誤訊息
- **AND** 提供可能的解決方案

#### Scenario: 影片資訊取得超時
- **WHEN** 取得影片資訊超過合理時間（如 30 秒）
- **THEN** 顯示超時錯誤訊息
- **AND** 允許使用者重試或取消

### Requirement: IPC 通訊
系統 SHALL 透過安全的 IPC 通訊在主進程和渲染進程之間傳遞影片相關資料。

#### Scenario: 載入影片 IPC 呼叫
- **WHEN** 渲染進程請求載入影片
- **THEN** 透過 IPC 發送 video:load 請求到主進程
- **AND** 主進程開啟檔案選擇對話框
- **AND** 返回選擇的檔案路徑

#### Scenario: 取得影片資訊 IPC 呼叫
- **WHEN** 渲染進程請求影片資訊
- **THEN** 透過 IPC 發送 video:get-info 請求到主進程
- **AND** 主進程使用 FFmpeg 取得資訊
- **AND** 返回影片資訊或錯誤訊息

